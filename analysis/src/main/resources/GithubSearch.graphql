query {
  search(
    first: ${max_results},
    ${page},
    type: ${type},
    query: "${search_query}",
  ) {
    pageInfo {
      endCursor
      hasNextPage
    }
    nodes {
      ... on Repository {
        id
        name
        createdAt
        pushedAt
        primaryLanguage {
          name
        }
        languages(first:${max_languages}) {
          nodes {
            name
          }
        }
        ...ownerRepositories
      }
    }
  }
}

fragment ownerRepositories on Repository {
  owner {
    id
    login
    pinnedRepositories(first: ${max_pinned_repositories}, orderBy: { field: UPDATED_AT, direction: DESC }) {
      ...repositoryConnections
    }
    repositories(first: ${max_repositories}, orderBy: { field: UPDATED_AT, direction: DESC }) {
      ...repositoryConnections
    }
  }
}

fragment repositoryConnections on RepositoryConnection {
  nodes {
    id
    name
    owner {
      login
    }
    isFork
    isMirror
    createdAt
    pushedAt
    primaryLanguage {
      name
    }
    languages(first:${max_languages}) {
      nodes {
        name
      }
    }
  }
}
